<!-- Single page application -->

<main class="main">
  <div class="header-text">
    <h1> Med Llava </h1>
    <h3> By Scott Spicer </h3>
    @if(!handset){
      <p>
        This site hosts an interactive demo of an AI assistant that answers
        multiple-choice medical questions by analyzing the accompanying image.
      </p>
      <p>
        Under the hood is a LLaVA model powered by Vicuna-13B.
        I fine-tuned it on 20,000 image-question pairs, boosting test set accuracy by 15%.
      </p>
      <app-heartbeat></app-heartbeat>
    }
  </div>

  <div class="inputs">
    @if(!handset){
      @if (!imageUploaded) {
        <div class="dropzone">
          <input type="file"
                id="fileDrop"
                (change)="onFileChange($event)">
          <h3>Drag & Drop Image File</h3>
          <mat-icon>attachment</mat-icon>
          <h3>or</h3>
          <label for="fileDrop" class="browseLabel">Browse for Image File</label>
        </div>
      }
      @else {
        <!-- instant preview -->
        <div class="uploadedImg">
          <img [src]="imageSrc">
          <button type="button" class="reset-button" style="width: 80%;" (click)="resetImage()">Clear Image</button>
        </div>
      }
    }
    @else{
      <div class="mobile-image-input-cont">
        <label for="fileDrop" style="font-weight:bold; text-decoration: underline;">Image</label>
        <input type="file" id="fileDrop" (change)="onFileChange($event)" class="mobile-image-input">
      </div>
    }

    <!-- #X is a reference to the DOM element in angular -->
    <div class="question-grid">
      <label for="question-input" style="font-weight:bold; text-decoration: underline;">Question</label>
      <textarea #q class="question-input" id="question-input" [(ngModel)]="input.question" (keydown)="jump($event, q, a)"></textarea>
    </div>


    <div class="choices-grid">
      <label for="a" style="font-weight:bold;">A: </label>
      <input #a type="text" id="a" [(ngModel)]="input.a" (keydown)="jump($event, a, b, q)">

      <label for="b" style="font-weight:bold;">B: </label>
      <input #b type="text" id="b" [(ngModel)]="input.b" (keydown)="jump($event, b, c, a)">

      <label for="c" style="font-weight:bold;">C: </label>
      <input #c type="text" id="c" [(ngModel)]="input.c" (keydown)="jump($event, c, d, b)">

      <label for="d" style="font-weight:bold;">D: </label>
      <input #d type="text" id="d" [(ngModel)]="input.d" (keydown)="jump($event, d, null, c)">
    </div>

    <div class="ctrl-button-container">
      <button (click)="reset()" class="reset-button">Reset</button>
      <button (click)="submit()" class="submit-button">Submit</button>
    </div>
    
    @if(showAnswer) {
      <p class="answerText">Answer: {{ answer }}</p>
    }

  
  </div>
  

</main>


<router-outlet />
